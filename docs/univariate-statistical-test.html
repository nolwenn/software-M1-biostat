<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Univariate statistical test | Little e-book for MPH1 computer labs</title>
  <meta name="description" content="This is a little book of essential biostatistic concepts for Master 1 in Public Health." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Univariate statistical test | Little e-book for MPH1 computer labs" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a little book of essential biostatistic concepts for Master 1 in Public Health." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Univariate statistical test | Little e-book for MPH1 computer labs" />
  
  <meta name="twitter:description" content="This is a little book of essential biostatistic concepts for Master 1 in Public Health." />
  

<meta name="author" content="Nolwenn Le Meur, PhD - EHESP associate professor in Biostatistics and Bioinformatic" />


<meta name="date" content="2022-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="regression-model.html"/>
<script src="libs/header-attrs-2.12/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li><a href="index.html#introduction">Introduction<span></span></a></li>
<li class="chapter" data-level="1" data-path="programming-environment.html"><a href="programming-environment.html"><i class="fa fa-check"></i><b>1</b> Programming environment<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="programming-environment.html"><a href="programming-environment.html#installation-r-and-stata"><i class="fa fa-check"></i><b>1.1</b> Installation R and Stata<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="programming-environment.html"><a href="programming-environment.html#r-packages"><i class="fa fa-check"></i><b>1.2</b> R packages<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="programming-environment.html"><a href="programming-environment.html#working-directory"><i class="fa fa-check"></i><b>1.3</b> Working directory<span></span></a>
<ul>
<li><a href="programming-environment.html#r">R<span></span></a></li>
<li><a href="programming-environment.html#stata">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="programming-environment.html"><a href="programming-environment.html#log-files-and-history"><i class="fa fa-check"></i><b>1.4</b> Log files and history<span></span></a>
<ul>
<li><a href="programming-environment.html#r-1">R<span></span></a></li>
<li><a href="programming-environment.html#stata-1">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="programming-environment.html"><a href="programming-environment.html#importing-data"><i class="fa fa-check"></i><b>1.5</b> Importing Data<span></span></a>
<ul>
<li><a href="programming-environment.html#r-2">R<span></span></a></li>
<li><a href="programming-environment.html#stata-2">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="programming-environment.html"><a href="programming-environment.html#saving-and-loading-r-and-stata-files"><i class="fa fa-check"></i><b>1.6</b> Saving and loading R and Stata files<span></span></a>
<ul>
<li><a href="programming-environment.html#r-3">R<span></span></a></li>
<li><a href="programming-environment.html#stata-3">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="programming-environment.html"><a href="programming-environment.html#delete-data-from-workspace"><i class="fa fa-check"></i><b>1.7</b> Delete data from workspace<span></span></a>
<ul>
<li><a href="programming-environment.html#r-4">R<span></span></a></li>
<li><a href="programming-environment.html#stata-4">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="programming-environment.html"><a href="programming-environment.html#data-quick-overview"><i class="fa fa-check"></i><b>1.8</b> Data quick overview<span></span></a>
<ul>
<li><a href="programming-environment.html#r-5">R<span></span></a></li>
<li><a href="programming-environment.html#stata-5">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="programming-environment.html"><a href="programming-environment.html#help-pages"><i class="fa fa-check"></i><b>1.9</b> Help pages<span></span></a>
<ul>
<li><a href="programming-environment.html#r-6">R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="programming-environment.html"><a href="programming-environment.html#function-call"><i class="fa fa-check"></i><b>1.10</b> Function call<span></span></a>
<ul>
<li><a href="programming-environment.html#r-7">R<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html"><i class="fa fa-check"></i><b>2</b> Data type and data format<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#data-type"><i class="fa fa-check"></i><b>2.1</b> Data type<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#numeric"><i class="fa fa-check"></i><b>2.1.1</b> Numeric<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-8">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-8">Stata<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#logical"><i class="fa fa-check"></i><b>2.1.2</b> Logical<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-9">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-9">Stata<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#date"><i class="fa fa-check"></i><b>2.1.3</b> Date<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-10">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-10">Stata<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#character"><i class="fa fa-check"></i><b>2.1.4</b> Character<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-11">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-11">Stata<span></span></a></li>
<li class="chapter" data-level="2.1.5" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#factor"><i class="fa fa-check"></i><b>2.1.5</b> Factor<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-12">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-12">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#data-format"><i class="fa fa-check"></i><b>2.2</b> Data format<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#vector"><i class="fa fa-check"></i><b>2.2.1</b> Vector<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-13">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-13">Stata<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#matrix"><i class="fa fa-check"></i><b>2.2.2</b> Matrix<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-14">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-14">Stata<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#data-set"><i class="fa fa-check"></i><b>2.2.3</b> Data (set)<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-15">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-15">Stata<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="data-type-and-data-format.html"><a href="data-type-and-data-format.html#list"><i class="fa fa-check"></i><b>2.2.4</b> List<span></span></a></li>
<li><a href="data-type-and-data-format.html#r-16">R<span></span></a></li>
<li><a href="data-type-and-data-format.html#stata-16">Stata<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-management.html"><a href="data-management.html"><i class="fa fa-check"></i><b>3</b> Data management<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-management.html"><a href="data-management.html#renaming-variables"><i class="fa fa-check"></i><b>3.1</b> Renaming variables<span></span></a>
<ul>
<li><a href="data-management.html#r-17">R<span></span></a></li>
<li><a href="data-management.html#stata-17">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-management.html"><a href="data-management.html#missing-values"><i class="fa fa-check"></i><b>3.2</b> Missing values<span></span></a>
<ul>
<li><a href="data-management.html#r-18">R<span></span></a></li>
<li><a href="data-management.html#stata-18">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-management.html"><a href="data-management.html#create-new-variables"><i class="fa fa-check"></i><b>3.3</b> Create new variables<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-management.html"><a href="data-management.html#changing-scale"><i class="fa fa-check"></i><b>3.3.1</b> Changing scale<span></span></a></li>
<li><a href="data-management.html#r-19">R<span></span></a></li>
<li><a href="data-management.html#stata-19">Stata<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="data-management.html"><a href="data-management.html#from-continuous-to-categorical"><i class="fa fa-check"></i><b>3.3.2</b> From continuous to categorical<span></span></a></li>
<li><a href="data-management.html#r-20">R<span></span></a></li>
<li><a href="data-management.html#stata-20">Stata<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="data-management.html"><a href="data-management.html#dummy-variables"><i class="fa fa-check"></i><b>3.3.3</b> Dummy variables<span></span></a></li>
<li><a href="data-management.html#r-21">R<span></span></a></li>
<li><a href="data-management.html#stata-21">Stata<span></span></a></li>
<li><a href="data-management.html#r-22">R<span></span></a></li>
<li><a href="data-management.html#stata-22">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-management.html"><a href="data-management.html#merging-data-set"><i class="fa fa-check"></i><b>3.4</b> Merging data set<span></span></a>
<ul>
<li><a href="data-management.html#r-23">R<span></span></a></li>
<li><a href="data-management.html#stata-23">Stata<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#quick-summary-statistics"><i class="fa fa-check"></i><b>4.1</b> Quick summary statistics<span></span></a>
<ul>
<li><a href="descriptive-statistics.html#r-24">R<span></span></a></li>
<li><a href="descriptive-statistics.html#stata-24">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#central-and-deviation-parameters"><i class="fa fa-check"></i><b>4.2</b> Central and deviation parameters<span></span></a>
<ul>
<li><a href="descriptive-statistics.html#r-25">R<span></span></a></li>
<li><a href="descriptive-statistics.html#stata-25">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>4.3</b> Confidence interval<span></span></a>
<ul>
<li><a href="descriptive-statistics.html#r-26">R<span></span></a></li>
<li><a href="descriptive-statistics.html#stata-26">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#cross-table"><i class="fa fa-check"></i><b>4.4</b> Cross table<span></span></a>
<ul>
<li><a href="descriptive-statistics.html#r-27">R<span></span></a></li>
<li><a href="descriptive-statistics.html#stata-27">Stata<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>5</b> Plotting<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="plotting.html"><a href="plotting.html#quantitative-data"><i class="fa fa-check"></i><b>5.1</b> Quantitative data<span></span></a>
<ul>
<li><a href="plotting.html#r-28">R<span></span></a></li>
<li><a href="plotting.html#stata-28">Stata<span></span></a></li>
<li><a href="plotting.html#r-29">R<span></span></a></li>
<li><a href="plotting.html#stata-29">Stata<span></span></a></li>
<li><a href="plotting.html#r-30">R<span></span></a></li>
<li><a href="plotting.html#stata-30">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="plotting.html"><a href="plotting.html#qualitative-data-categorical"><i class="fa fa-check"></i><b>5.2</b> Qualitative data (categorical)<span></span></a>
<ul>
<li><a href="plotting.html#r-31">R<span></span></a></li>
<li><a href="plotting.html#stata-31">Stata<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="univariate-statistical-test.html"><a href="univariate-statistical-test.html"><i class="fa fa-check"></i><b>6</b> Univariate statistical test<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="univariate-statistical-test.html"><a href="univariate-statistical-test.html#quantitative-data-1"><i class="fa fa-check"></i><b>6.1</b> Quantitative data<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="univariate-statistical-test.html"><a href="univariate-statistical-test.html#two-groups-comparison"><i class="fa fa-check"></i><b>6.1.1</b> Two groups comparison<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="univariate-statistical-test.html"><a href="univariate-statistical-test.html#anova"><i class="fa fa-check"></i><b>6.1.2</b> ANOVA or Kruskal-Wallis tests<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="univariate-statistical-test.html"><a href="univariate-statistical-test.html#qualitative-data-categorical-1"><i class="fa fa-check"></i><b>6.2</b> Qualitative data (categorical)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression-model.html"><a href="regression-model.html"><i class="fa fa-check"></i><b>7</b> Regression model<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-model.html"><a href="regression-model.html#linear-regression"><i class="fa fa-check"></i><b>7.1</b> Linear regression<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regression-model.html"><a href="regression-model.html#simple-linear-regression"><i class="fa fa-check"></i><b>7.1.1</b> Simple Linear regression<span></span></a></li>
<li><a href="regression-model.html#r-39">R<span></span></a></li>
<li><a href="regression-model.html#stata-39">Stata<span></span></a></li>
<li><a href="regression-model.html#r-40">R<span></span></a></li>
<li><a href="regression-model.html#stata-40">Stata<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="regression-model.html"><a href="regression-model.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>7.1.2</b> multivariate linear regression<span></span></a></li>
<li><a href="regression-model.html#r-41">R<span></span></a></li>
<li><a href="regression-model.html#stata-41">Stata<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regression-model.html"><a href="regression-model.html#logistic-regression"><i class="fa fa-check"></i><b>7.2</b> logistic regression<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="regression-model.html"><a href="regression-model.html#simple-logistic-regression"><i class="fa fa-check"></i><b>7.2.1</b> simple logistic regression<span></span></a></li>
<li><a href="regression-model.html#r-42">R<span></span></a></li>
<li><a href="regression-model.html#stata-42">Stata<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="regression-model.html"><a href="regression-model.html#multivariate-logistic-regression"><i class="fa fa-check"></i><b>7.2.2</b> multivariate logistic regression<span></span></a></li>
<li><a href="regression-model.html#r-43">R<span></span></a></li>
<li><a href="regression-model.html#stata-43">Stata<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Little e-book for MPH1 computer labs</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="univariate-statistical-test" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Univariate statistical test<a href="univariate-statistical-test.html#univariate-statistical-test" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In statistical analysis plan (SAP), univariate tests are recommended. In epidemiology it permits a first assessment of possible relationships between the outcome and the covariates (or possible confounders).</p>
<p>The choice of the test depends on the type of the variable, the shape of its distribution, and the number of groups to compare.</p>
<div id="quantitative-data-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Quantitative data<a href="univariate-statistical-test.html#quantitative-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="two-groups-comparison" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Two groups comparison<a href="univariate-statistical-test.html#two-groups-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compare the distribution of a <strong>quantitative variable between 2 groups</strong> you first need to describe the distribution of the data (shape) to choose between a parametric or a non-parametric test.</p>
<p><strong>Parametric tests</strong> are based on the parameters of the distribution <em>i.e.</em> the mean and the variance of the data series therefore the mean should be a reliable and correct parameter to summarize the distribution of the values in the 2 groups. The distributions should be similar to a <strong>Normal distribution</strong> (Bell-shape like) and not skewed. To verify this assumption one can use the <a href="univariate-statistical-test.html#shapiro-test">Shapiro test</a>. In addition, the 2 groups should have similar variance or the test will have to be adjusted for uneven variances. To verify this assumption one can do a variance test.</p>
<p>In all examples below, we are interested to see the risk factors for sleep apnea.</p>
<div id="shapiro-test" class="section level4 unnumbered hasAnchor">
<h4>Shapiro test<a href="univariate-statistical-test.html#shapiro-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The hypothesis of the Shapiro test are:</p>
<ul>
<li>H0: sleep apnea is normally distributed (equal to a Normal distribution)</li>
<li>H1: sleep apnea is different/not normally distributed (different from)</li>
<li>with alpha= 5%</li>
</ul>
</div>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-32" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-32" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="univariate-statistical-test.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;sleepApnea-clean.Rdata&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="univariate-statistical-test.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># globally</span></span>
<span id="cb2-2"><a href="univariate-statistical-test.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># shapiro.test(sleep$SleepApnea)</span></span>
<span id="cb2-3"><a href="univariate-statistical-test.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># But we want to compare 2 groups</span></span>
<span id="cb2-4"><a href="univariate-statistical-test.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(sleep<span class="sc">$</span>SleepApnea, sleep<span class="sc">$</span>gender, shapiro.test)</span></code></pre></div>
<pre><code>## sleep$gender: female
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.86531, p-value = 0.01203
## 
## ------------------------------------------------------------ 
## sleep$gender: male
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.93775, p-value = 6.453e-05</code></pre>
<p>In both group, the p-value is below 5%. We reject H0. The sleep apnea data do not follow a Normal distribution. We should use <a href="#Wilcoxon">Wilcoxon test</a>, a non-parametric test to compare 2 groups not normally distributed.</p>
<p>We can try a log transformation on the data, a mathematical trick that (sometimes) helps reshaping the distribution into a Normal distribution</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="univariate-statistical-test.html#cb4-1" aria-hidden="true" tabindex="-1"></a>sleep<span class="sc">$</span>SleepApnea_log <span class="ot">&lt;-</span> <span class="fu">log</span>(sleep<span class="sc">$</span>SleepApnea)</span>
<span id="cb4-2"><a href="univariate-statistical-test.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># To compare the 2 groups</span></span>
<span id="cb4-3"><a href="univariate-statistical-test.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(sleep<span class="sc">$</span>SleepApnea_log, sleep<span class="sc">$</span>gender,shapiro.test)</span></code></pre></div>
<pre><code>## sleep$gender: female
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.95755, p-value = 0.5251
## 
## ------------------------------------------------------------ 
## sleep$gender: male
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.98737, p-value = 0.3932</code></pre>
<p>Indeed, this time we fail to reject H0 for the 2 groups. We can state now that we cannot prove that the 2 data series are different from Normal distribution and a parametric test can be used for comparison. We will be able to apply a <a href="univariate-statistical-test.html#student-t-test">Student t-test</a> on the log-transformed sleep apnea data.</p>
</div>
<div id="stata-32" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-32" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The analysis steps are the same in STATA and the syntax is similar.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb6-1"><a href="univariate-statistical-test.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">swilk</span> SleepApnea, <span class="kw">by</span>(gender)</span></code></pre></div>
<p>In both groups, the p-value is below 5%. We reject H0. The sleep apnea data do not follow a Normal distribution. We should use <a href="#Wilcoxon"><strong>Wilcoxon test</strong></a>, a non-parametric test to compare 2 groups not normally distributed.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb7-1"><a href="univariate-statistical-test.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> SleepApnea_log = <span class="fu">log</span>(SleepApnea) </span>
<span id="cb7-2"><a href="univariate-statistical-test.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">swilk</span> SleepApnea_log, <span class="kw">by</span>(gender)</span></code></pre></div>
<p>After log-transformation, we cannot show that the data distributions are different from a Normal distribution. We will be able to use a <a href="univariate-statistical-test.html#student-t-test">Student T-test</a> (parametric test) on the log-transformed data series.</p>
</div>
</div>
<div id="homoscedasticity-or-homogeneity-of-variances" class="section level4 unnumbered hasAnchor">
<h4>Homoscedasticity or homogeneity of variances<a href="univariate-statistical-test.html#homoscedasticity-or-homogeneity-of-variances" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the configuration of a parametric test, the variances have to be equal in order to perform a classical <a href="univariate-statistical-test.html#student-t-test">Student t-test</a>.</p>
<p>The hypothesis are:</p>
<ul>
<li>H0: the variance of sleep apnea values among female is equal to the variance of sleep apnea values among male</li>
<li>H1: the variance of sleep apnea values among female is not equal to the variance of sleep apnea values among male</li>
<li>with alpha= 5%</li>
</ul>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-33" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-33" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Bartlett’s test assess that the variances in each of the groups (samples) are the same.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="univariate-statistical-test.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(SleepApnea_log<span class="sc">~</span>gender, <span class="at">data=</span>sleep)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  SleepApnea_log by gender
## Bartlett&#39;s K-squared = 1.5169, df = 1, p-value = 0.2181</code></pre>
<p>The p-value is 0.21, we fail to reject H0. The variance are homogeneous and the adjustement will be required for the t-test.</p>
<p>Note: The <em>var.test()</em> is a special case of comparing variances in two samples from normal distributions.</p>
</div>
<div id="stata-33" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-33" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A similar syntax is available in STATA.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb10-1"><a href="univariate-statistical-test.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">sdtest</span> SleepApnea_log, <span class="kw">by</span>(gender)</span></code></pre></div>
</div>
</div>
<div id="student-t-test" class="section level4 unnumbered hasAnchor">
<h4>Student t-test<a href="univariate-statistical-test.html#student-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Since the log-transformed data are not different from a Normal distribution and the variances are homogeneous in both gender group, we can applied a Student T-test to the sleep apnea values to answer the following hypothesis:</p>
<ul>
<li>H0: On average,in log scale, the sleep apnea values among female is equal to the sleep apnea values among male</li>
<li>H1: On average, in log scale, the sleep apnea values among female is not equal to the sleep apnea values among male</li>
<li>with alpha= 5%</li>
</ul>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-34" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-34" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The output of <em>t.test()</em> function call takes too much room on the web page so for display purpose we stored the results in a variable that we named <em>ttest_res</em>. We can then retrieve elements of results by their names in the list (see help page for details). For instance, the p-value can be access as follow:</p>
<div class="sourceCode" id="cb11" style="&#39;display:inline-block"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="univariate-statistical-test.html#cb11-1" aria-hidden="true" tabindex="-1"></a>ttest_res <span class="ot">&lt;-</span> <span class="fu">t.test</span>(SleepApnea_log<span class="sc">~</span>gender, <span class="at">var.qual=</span><span class="cn">TRUE</span>, <span class="at">data=</span>sleep)</span>
<span id="cb11-2"><a href="univariate-statistical-test.html#cb11-2" aria-hidden="true" tabindex="-1"></a>ttest_res<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.903352</code></pre>
<p>The test shows that we fail to reject H0. We cannot show any differences between gender as sleep apnea is concerned.</p>
<p>Note: (1) storing the results of a test in an object can become handy when one want iterate the test over several covariates. (2) By default the <em>t.test()</em> function is set for unequal variance.</p>
</div>
<div id="stata-34" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-34" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Again, the syntax is similar in STATA.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb13-1"><a href="univariate-statistical-test.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ttest</span> SleepApnea_log, <span class="kw">by</span>(gender)</span></code></pre></div>
</div>
</div>
<div id="wilcoxon-test" class="section level4 unnumbered hasAnchor">
<h4>Wilcoxon test<a href="univariate-statistical-test.html#wilcoxon-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Non parametric tests can always be used but they tend to be less powerful, meaning that they are less likely to identify small differences in small sample.</p>
<p>The Wilcoxon test is based solely on the order in which the observations
from the two samples fall. It is also know as the Wilcoxon rank sum test. The null hypothesis tested is:</p>
<ul>
<li>H0: The distribution of the sleep apnea values among female and male are equal</li>
<li>H1: The distribution of the sleep apnea values among female and male are not equal</li>
<li>with alpha= 5%</li>
</ul>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-35" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-35" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>R</strong> to perform a one- and two-sample non-parametric rank sum test you should use the <em>wilcoxon.test()</em> function on vectors of data. The two-sample test is also known as <em>Mann-Whitney</em> test but used the same the function call.</p>
<p>If we use it on the original sleep apnea data</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="univariate-statistical-test.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(sleep<span class="sc">$</span>SleepApnea, sleep<span class="sc">$</span>gender,shapiro.test)</span></code></pre></div>
<pre><code>## sleep$gender: female
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.86531, p-value = 0.01203
## 
## ------------------------------------------------------------ 
## sleep$gender: male
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.93775, p-value = 6.453e-05</code></pre>
<p>The conclusion is the same as with the log-transformed scale and parametric test. Here, we fail to reject H0. No difference can be shown between gender which adds evidence against gender related outcome.</p>
</div>
<div id="stata-35" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-35" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>Stata</strong> the name of the function is more in link with the actual computation:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb16-1"><a href="univariate-statistical-test.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">ranksum</span> SleepApnea, <span class="kw">by</span>(gender)</span></code></pre></div>
</div>
</div>
<div id="anova" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> ANOVA or Kruskal-Wallis tests<a href="univariate-statistical-test.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compare more than 2 groups you should use a generalization of the T-test or Wilcoxon test.</p>
<div id="anova-1" class="section level4 unnumbered hasAnchor">
<h4>ANOVA<a href="univariate-statistical-test.html#anova-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To perform an ANOVA (ANalyse Of VAriance) you do the same assumption as for the T-test: normality of the values in the different group and homogeneity of the variances. Although the ANOVA test is less sensitive to Normality and homoscedasticity deviation than the T-test.</p>
</div>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-36" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-36" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>R</strong>, let’s look at the cholesterol in groups along with the sleep apnea response variable?</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="univariate-statistical-test.html#cb17-1" aria-hidden="true" tabindex="-1"></a>sleep<span class="sc">$</span>chlgr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sleep<span class="sc">$</span>cholesterol <span class="sc">&lt;=</span> <span class="dv">2</span>, </span>
<span id="cb17-2"><a href="univariate-statistical-test.html#cb17-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;normal&quot;</span>, </span>
<span id="cb17-3"><a href="univariate-statistical-test.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(sleep<span class="sc">$</span>cholesterol <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> </span>
<span id="cb17-4"><a href="univariate-statistical-test.html#cb17-4" aria-hidden="true" tabindex="-1"></a>                               sleep<span class="sc">$</span>cholesterol<span class="sc">&lt;=</span> <span class="fl">2.39</span>,</span>
<span id="cb17-5"><a href="univariate-statistical-test.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;bordeline high&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb17-6"><a href="univariate-statistical-test.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(sleep<span class="sc">$</span>SleepApnea, sleep<span class="sc">$</span>chlgr,shapiro.test)</span></code></pre></div>
<pre><code>## sleep$chlgr: bordeline high
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.96073, p-value = 0.1569
## 
## ------------------------------------------------------------ 
## sleep$chlgr: high
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.89608, p-value = 0.01509
## 
## ------------------------------------------------------------ 
## sleep$chlgr: normal
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.91099, p-value = 0.0002685</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="univariate-statistical-test.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(sleep<span class="sc">$</span>SleepApnea_log, sleep<span class="sc">$</span>chlgr,shapiro.test)</span></code></pre></div>
<pre><code>## sleep$chlgr: bordeline high
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.96631, p-value = 0.2469
## 
## ------------------------------------------------------------ 
## sleep$chlgr: high
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.98136, p-value = 0.9107
## 
## ------------------------------------------------------------ 
## sleep$chlgr: normal
## 
##  Shapiro-Wilk normality test
## 
## data:  dd[x, ]
## W = 0.98139, p-value = 0.4677</code></pre>
<p>The sleep apnea variable in its original scale is not normally distributed in 2 of the 3 groups of cholesterol, with quite an important deviation for latest (High cholesterol). In the log transformed data, all distribution are similar to a normal distribution.</p>
<p>Next, we look at the homoscedasticity:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="univariate-statistical-test.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(sleep<span class="sc">$</span>SleepApnea_log <span class="sc">~</span> sleep<span class="sc">$</span>chlgr)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  sleep$SleepApnea_log by sleep$chlgr
## Bartlett&#39;s K-squared = 0.45559, df = 2, p-value = 0.7963</code></pre>
<p>Finally, we can perform an ANOVA than will assess whether the variance within groups is similar than between group (H0) or not (H1).</p>
<ul>
<li>H0: On average,in log scale, the sleep apnea values among the different groups of cholesterol are equal</li>
<li>H1: At least one cholesterol group differs from the other in term of sleep apnea values</li>
<li>with alpha= 5%</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="univariate-statistical-test.html#cb23-1" aria-hidden="true" tabindex="-1"></a>res_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(sleep<span class="sc">$</span>SleepApnea_log <span class="sc">~</span> sleep<span class="sc">$</span>chlgr)</span>
<span id="cb23-2"><a href="univariate-statistical-test.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res_anova)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## sleep$chlgr   2  0.463  0.2314   1.095  0.338
## Residuals   126 26.619  0.2113               
## 1 observation deleted due to missingness</code></pre>
<p>In conclusion, we fail to reject H0. We cannot demonstrate any statistically significant associated between log sleep apnea and cholesterol group levels.</p>
<p>If any statistically significant association was observed we could have used the <em>TukeyHSD()</em> to decipher which group. This <strong>post-hoc pairwise comparison</strong> is commonly performed after significant effects when there are three or more levels of a factor.</p>
</div>
<div id="stata-36" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-36" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>Stata</strong> the name of the function is more in link with the actual computation:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb25-1"><a href="univariate-statistical-test.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">// generate cholesterol groups</span></span>
<span id="cb25-2"><a href="univariate-statistical-test.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">generate</span> <span class="kw">byte</span> chlgr=1 <span class="kw">if</span> cholesterol &lt;= 2</span>
<span id="cb25-3"><a href="univariate-statistical-test.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> chlgr=2 <span class="kw">if</span> cholesterol&gt;2 </span>
<span id="cb25-4"><a href="univariate-statistical-test.html#cb25-4" aria-hidden="true" tabindex="-1"></a>                &amp; cholesterol&lt;=2.39</span>
<span id="cb25-5"><a href="univariate-statistical-test.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="kw">replace</span> chlgr= 3 <span class="kw">if</span> cholesterol&gt;2.39 </span>
<span id="cb25-6"><a href="univariate-statistical-test.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">// test normality and homoscedasticity</span></span>
<span id="cb25-7"><a href="univariate-statistical-test.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="kw">swilk</span> SleepApnea_log, <span class="kw">by</span>(chlgr)</span>
<span id="cb25-8"><a href="univariate-statistical-test.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="kw">sdtest</span> SleepApnea_log, <span class="kw">by</span>(chlgr)</span>
<span id="cb25-9"><a href="univariate-statistical-test.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">// ANOVA</span></span>
<span id="cb25-10"><a href="univariate-statistical-test.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="kw">oneway</span> SleepApnea_log chlgr</span></code></pre></div>
<p>Stata has three built-in pairwise methods (sidak, bonferroni and scheffe) in the oneway command. Although these options are easy to use, many researchers consider the methods to be too conservative for pairwise comparisons, especially when the are many levels. The Sidak method is the least conservative of the three followed, in order, by Bonferroni and Scheffe.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb26-1"><a href="univariate-statistical-test.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">oneway</span> SleepApnea_log chlgr, sidak bonferroni scheffe</span></code></pre></div>
<p>Stata does not have a simple Tukey test command built-in, a few easy steps will download a user-created one that works just as well. Assuming you have not already installed the command, type <em>findit tukeyhsd</em> into the Command window and click on the appropriate link for download (see <a href="https://www.reed.edu/psychology/stata/analyses/parametric/ANOVA/tukey.html">Reed College</a> help page for details).</p>
<p>Next, you only need to call the function</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb27-1"><a href="univariate-statistical-test.html#cb27-1" aria-hidden="true" tabindex="-1"></a>tukeyhsd  chlgr</span></code></pre></div>
</div>
</div>
</div>
<div id="qualitative-data-categorical-1" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Qualitative data (categorical)<a href="univariate-statistical-test.html#qualitative-data-categorical-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Outcome and covariate can be both categorical and univariate statistical tests are then based on counts (although hypothesis are expressed in proportion).</p>
<div id="fisher-exact-test" class="section level4 unnumbered hasAnchor">
<h4>Fisher Exact Test<a href="univariate-statistical-test.html#fisher-exact-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Fisher Exact test is the most accurate and powerful test for qualitative data. The only limit is the greedy permutation algorithm that your personal computer may not be in capacity to handle.</p>
<p>Let’s look at the high apneic patients (sleep apnea level above 69) and its possible relationship with obesity. The null hypothesis is:</p>
<ul>
<li>H0: Among the highly apneic patients, the proportion obese persona is equal to the proportion of normal weight persona</li>
<li>H1: The proportion obese persona is not equal in the group of highly apneic patients and the low (or no) apneic patients</li>
<li>with alpha= 5%</li>
</ul>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-37" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-37" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>R</strong> we first create the <em>apnea_high</em> variable as a categorical variable (factor). Next, we use the <em>fisher.test()</em> function call</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="univariate-statistical-test.html#cb28-1" aria-hidden="true" tabindex="-1"></a>sleep<span class="sc">$</span>apnea_high <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(sleep<span class="sc">$</span>SleepApnea <span class="sc">&gt;</span> <span class="dv">69</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)</span>
<span id="cb28-2"><a href="univariate-statistical-test.html#cb28-2" aria-hidden="true" tabindex="-1"></a>sleep<span class="sc">$</span>apnea_high <span class="ot">&lt;-</span> <span class="fu">factor</span>(sleep<span class="sc">$</span>apnea_high)</span>
<span id="cb28-3"><a href="univariate-statistical-test.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span> sleep<span class="sc">$</span>obese <span class="sc">+</span> sleep<span class="sc">$</span>apnea_high )</span></code></pre></div>
<pre><code>##            sleep$apnea_high
## sleep$obese No Yes
##           0 89   8
##           1 25   7</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="univariate-statistical-test.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(sleep<span class="sc">$</span>obese, sleep<span class="sc">$</span>apnea_high)</span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  sleep$obese and sleep$apnea_high
## p-value = 0.05407
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##   0.8615118 10.8256470
## sample estimates:
## odds ratio 
##   3.081952</code></pre>
<p>We gather from the test we cannot reject H0 and there do not seem have a relationship between high sleep apnea level and obesity (p-value 0.054). Although the p-value is borderline and that observation might be due to a lack of power (by construction) as only 15 patients are in the High apnea group.</p>
</div>
<div id="stata-37" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-37" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb32-1"><a href="univariate-statistical-test.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">gen</span> apnea_high = SleepApnea &gt; 69  </span>
<span id="cb32-2"><a href="univariate-statistical-test.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">tabulate</span> apnea_high obese, exact</span></code></pre></div>
</div>
</div>
<div id="pearson-chi-square-test" class="section level4 unnumbered hasAnchor">
<h4>Pearson Chi-Square Test<a href="univariate-statistical-test.html#pearson-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An alternative to the <a href="univariate-statistical-test.html#fisher-exact-test">Fisher Exact test</a> is the Chi-Square test. The hypothesis are the same but there is one assumption for the Chi-Square: all expected counts should be greater than 5 otherwise the p-value will be poorly estimated.</p>
</div>
<div style="display: grid; grid-template-columns: 1fr 1fr; grid-column-gap: 30px;">
<div id="r-38" class="section level3 unnumbered hasAnchor">
<h3>R<a href="univariate-statistical-test.html#r-38" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="univariate-statistical-test.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create contingency table</span></span>
<span id="cb33-2"><a href="univariate-statistical-test.html#cb33-2" aria-hidden="true" tabindex="-1"></a>aHigh2ob <span class="ot">&lt;-</span> <span class="fu">table</span>(sleep<span class="sc">$</span>apnea_high, sleep<span class="sc">$</span>obese)</span>
<span id="cb33-3"><a href="univariate-statistical-test.html#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the test and store the result </span></span>
<span id="cb33-4"><a href="univariate-statistical-test.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># in a object aHigh2ob_chisq</span></span>
<span id="cb33-5"><a href="univariate-statistical-test.html#cb33-5" aria-hidden="true" tabindex="-1"></a>aHigh2ob_chisq <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(aHigh2ob)</span>
<span id="cb33-6"><a href="univariate-statistical-test.html#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># After the R warning</span></span>
<span id="cb33-7"><a href="univariate-statistical-test.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># verify the expected counts</span></span>
<span id="cb33-8"><a href="univariate-statistical-test.html#cb33-8" aria-hidden="true" tabindex="-1"></a>aHigh2ob_chisq<span class="sc">$</span>expected</span></code></pre></div>
<pre><code>##      
##              0        1
##   No  85.72093 28.27907
##   Yes 11.27907  3.72093</code></pre>
<p>Here one expected count is 3.72 <span class="math inline">\(&lt;\)</span> 5 so you should not use the result of that test which are too much approximated.</p>
</div>
<div id="stata-38" class="section level3 unnumbered hasAnchor">
<h3>Stata<a href="univariate-statistical-test.html#stata-38" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In <strong>Stata</strong> the test is computed and the Yates correction is proposed but I would advise to add the <em>expected</em> keyword to you function call to also have the expected counts displayed along the results of the test.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode stata"><code class="sourceCode stata"><span id="cb35-1"><a href="univariate-statistical-test.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">tabulate</span> apnea_high obese, <span class="fu">chi2</span> expected</span></code></pre></div>
</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regression-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06_r_stata_univariate_statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
